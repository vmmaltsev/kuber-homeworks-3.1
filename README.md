# Домашнее задание к занятию «Компоненты Kubernetes» - `Мальцев Виктор`

---

Задание. Необходимо определить требуемые ресурсы
Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

Необходимо упаковать приложение в чарт для деплоя в разные окружения.
База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
Кеш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий.
Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

Ответ:


Для начала выполним расчёт всех необходимых ресурсов, учитывая требования к каждому компоненту системы:

База данных:

	ОЗУ: 4 ГБ на копию, всего 3 копии, итого 12 ГБ ОЗУ.
	CPU: 1 ядро на копию, всего 3 копии, итого 3 ядра.

Система кеширования:

	ОЗУ: 4 ГБ на копию, всего 3 копии, итого 12 ГБ ОЗУ.
	CPU: 1 ядро на копию, всего 3 копии, итого 3 ядра.

Фронтенд:

	ОЗУ: 50 МБ на экземпляр, всего 5 копий, итого 250 МБ ОЗУ.
	CPU: 0.2 ядра на экземпляр, всего 5 копий, итого 1 ядро.

Бекенд:

	ОЗУ: 600 МБ на копию, всего 10 копий, итого 6 ГБ ОЗУ.
	CPU: 1 ядро на копию, всего 10 копий, итого 10 ядер.

Итого, без учёта запаса и служебных ресурсов:

	ОЗУ: 12 ГБ (БД) + 12 ГБ (Кеш) + 0.25 ГБ (Фронтенд) + 6 ГБ (Бекенд) = 30.25 ГБ.
	CPU: 3 ядра (БД) + 3 ядра (Кеш) + 1 ядро (Фронтенд) + 10 ядер (Бекенд) = 17 ядер.

Теперь добавим запас на выход из строя одной ноды. Обычно достаточно 20-25% к основным ресурсам, чтобы обеспечить отказоустойчивость:

	ОЗУ: 30.25 ГБ + 25% = 37.81 ГБ.
	CPU: 17 ядер + 25% = 21.25 ядер.

Для служебных ресурсов и операционной системы добавим примерно 4 ГБ ОЗУ и 2 ядра на каждую ноду.

Теперь прикинем количество нод. Если предположить, что одна нода может иметь 64 ГБ ОЗУ и 16 ядер CPU, то:

	По ОЗУ: 37.81 ГБ + 4 ГБ (служебные ресурсы) = 41.81 ГБ, что умещается в одну ноду.
	По CPU: 21.25 ядер + 2 ядра (служебные ресурсы) = 23.25 ядер, что требует как минимум двух нод, так как одна нода предоставляет только 16 ядер.

Таким образом, минимальное количество нод для обеспечения требуемых ресурсов и отказоустойчивости — 2 ноды. Каждая нода имеет параметры:

	ОЗУ: 64 ГБ (для покрытия максимальных требований по ОЗУ).
	CPU: 16 ядер (для покрытия требований по CPU).